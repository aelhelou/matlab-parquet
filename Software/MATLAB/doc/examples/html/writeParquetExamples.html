<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2018a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Examples of Writing data to Parquet</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.234001159668px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-style: normal; font-size: 13.9999990463257px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { text-align: left; line-height: 26.3999977111816px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { text-align: left; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S5 { text-align: left; line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S7 { min-height: 18px; white-space: nowrap; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { min-height: 0px; white-space: pre; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { color: rgb(160, 32, 240); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S11 { text-align: left; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S12 { color: rgb(34, 139, 34); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.CodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.CodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment'><h1 class = "S1"><span class = "S2"><span class="S0">Examples of Writing data to Parquet</span></span></h1><div class = "S3"><span class = "S2"><span class="S0">Small snippets of writing various data types to file</span></span></div><div class = "S3"><span class = "S2"><span class="S0">All examples should read back exactly, you can confirm this with:</span></span></div><div class = "S3"><span class = "S2"><span class="S4">assert(isequaln(parquetread('tmp.parquet'), data)))</span></span></div></div><div class = "S0"></div><div class = 'SectionBlock containment active'><h2 class = "S5"><span class = "S2"><span class="S0">Write a numeric array</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">rows = 1e6;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">cols = 10;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">maxi = 65536;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = [(1 : rows)', randi(maxi,rows,cols)];</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0"></span><span class="S0">parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">assert(isequaln(parquetread(</span><span class="S9">'tmp.parquet'</span><span class="S0">), data))</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><div class = "S3"><span class = "S2"><span class="S0">Same as above but this time we will append data to the file</span></span></div><div class = "S3"><span class = "S2"><span class="S0">First write some data to file with </span></span><span class = "S2"><span class="S4">AppenData </span></span><span class = "S2"><span class="S0">flag set to </span></span><span class = "S2"><span class="S4">true</span></span></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = rand(10);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">writer = parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">,</span><span class="S9">'AppendData'</span><span class="S0">, true);</span></span></div></div></div><div class = "S11"><span class = "S2"><span class="S0">Write some more data to file</span></span></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">writer.write(rand(10))</span></span></div></div></div><div class = "S11"><span class = "S2"><span class="S0">When there is no more data to write, we call the </span></span><span class = "S2"><span class="S4">finish</span></span><span class = "S2"><span class="S0"> method</span></span></div><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">writer.finish</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2"><span class="S0">Write a table</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">rows = 100;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">cols = 2;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">maxi = 65536;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = array2table([(1 : rows)', randi(maxi,rows,cols)]);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">assert(isequaln(parquetread(</span><span class="S9">'tmp.parquet'</span><span class="S0">), data))</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2"><span class="S0">Write a table with RowNames</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">rows = 100;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">cols = 2;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">maxi = 65536;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = array2table([(1 : rows)', randi(maxi,rows,cols)]);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data.Properties.RowNames = cellstr(</span><span class="S9">"Row"</span><span class="S0">+(1:100))';</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">assert(isequaln(parquetread(</span><span class="S9">'tmp.parquet'</span><span class="S0">), data))</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2"><span class="S0">Write a timetable</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S12">% Create 10 stock returns for a year</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">days = datetime(2000,1,1) : datetime(2000,12,31);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">n    = length(days);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">s    = 10;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">r    = cumsum(randn(n,s));</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = array2timetable(r,</span><span class="S9">'RowTimes'</span><span class="S0">,days');</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S12">% Add a field named Text that stores news event id's</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data.Text = </span><span class="S9">"News_" </span><span class="S0">+ (1 : n)';</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">assert(isequaln(parquetread(</span><span class="S9">'tmp.parquet'</span><span class="S0">), data))</span></span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S5"><span class = "S2"><span class="S0">Write a structure</span></span></h2><div class = 'CodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">rows = 100;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">cols = 2;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">maxi = 65536;</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = array2table([(1 : rows)', randi(maxi,rows,cols)]);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">data = table2struct(data,</span><span class="S9">'ToScalar'</span><span class="S0">,true);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0"></span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">parquetwrite(data,</span><span class="S9">'tmp.parquet'</span><span class="S0">,</span><span class="S9">'WriteMode'</span><span class="S0">,</span><span class="S9">'OVERWRITE'</span><span class="S0">);</span></span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8"><span class="S0">assert(isequaln(parquetread(</span><span class="S9">'tmp.parquet'</span><span class="S0">), data))</span></span></div></div></div></div></div><br><!-- <br>##### SOURCE BEGIN #####<br>%% Examples of Writing data to Parquet<br>% Small snippets of writing various data types to file<br>% <br>% All examples should read back exactly, you can confirm this with:<br>% <br>% |assert(isequaln(parquetread('tmp.parquet'), data)))|<br>%% Write a numeric array<br>%%<br>rows = 1e6;<br>cols = 10;<br>maxi = 65536;<br>data = [(1 : rows)', randi(maxi,rows,cols)];<br>parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE');<br>assert(isequaln(parquetread('tmp.parquet'), data))<br>%% <br>% Same as above but this time we will append data to the file<br>% <br>% First write some data to file with |AppenData |flag set to |true|<br>%%<br>data = rand(10);<br>writer = parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE','AppendData', true);<br>%% <br>% Write some more data to file<br><br>writer.write(rand(10))<br>%% <br>% When there is no more data to write, we call the |finish| method<br><br>writer.finish<br>%% Write a table<br>%%<br>rows = 100;<br>cols = 2;<br>maxi = 65536;<br>data = array2table([(1 : rows)', randi(maxi,rows,cols)]);<br>parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE');<br>assert(isequaln(parquetread('tmp.parquet'), data))<br>%% Write a table with RowNames<br>%%<br>rows = 100;<br>cols = 2;<br>maxi = 65536;<br>data = array2table([(1 : rows)', randi(maxi,rows,cols)]);<br>data.Properties.RowNames = cellstr("Row"+(1:100))';<br><br>parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE');<br>assert(isequaln(parquetread('tmp.parquet'), data))<br>%% Write a timetable<br>%%<br>% Create 10 stock returns for a year<br>days = datetime(2000,1,1) : datetime(2000,12,31);<br>n    = length(days);<br>s    = 10;<br>r    = cumsum(randn(n,s));<br>data = array2timetable(r,'RowTimes',days');<br><br>% Add a field named Text that stores news event id's<br>data.Text = "News_" + (1 : n)';<br><br>parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE');<br>assert(isequaln(parquetread('tmp.parquet'), data))<br>%% Write a structure<br>%%<br>rows = 100;<br>cols = 2;<br>maxi = 65536;<br>data = array2table([(1 : rows)', randi(maxi,rows,cols)]);<br>data = table2struct(data,'ToScalar',true);<br><br>parquetwrite(data,'tmp.parquet','WriteMode','OVERWRITE');<br>assert(isequaln(parquetread('tmp.parquet'), data))<br>##### SOURCE END #####<br>--></body></html>